{% load static humanize wagtailcore_tags wagtailimages_tags %}
<div class="catalog-card" role="region" aria-label="{{ courseware_page.title }}">
    <div class="top">
        <div class="cover-image">
            <div class="cover-image-frame">
                {% if courseware_page.thumbnail_image %}
                    {% image courseware_page.thumbnail_image fill-275x155 %}
                {% else %}
                    <img src="{% static default_image_path %}" alt="Preview image">
                {% endif %}
            </div>
        </div>
        <div class="top-level-details">
            <h3 class="title">
                    <a href="{% pageurl courseware_page %}">
                        {{ courseware_page.title }}
                    </a>
            </h3>
            <ul>
                {% firstof courseware_page.product.current_price courseware_page.product.first_unexpired_run.current_price as price %}
                {% if price %}
                    <li>
                        <strong>Price:</strong>
                        ${{ price|floatformat:"0"|intcomma }}
                    </li>
                {% endif %}
                {% if object_type == "program" %}
                    <li>
                        <strong>Number of Courses:</strong>
                        {{ courseware_page.product.courses.count }}
                    </li>
                {% endif %}
                {% if courseware_page.duration %}
                    <li>
                        <strong>Duration:</strong>
                        {{ courseware_page.duration }}
                    </li>
                {% endif %}
                {% if courseware_page.product.next_run_date %}
                    <li>
                        <strong>Next Start Date:</strong>
                        {{ courseware_page.product.next_run_date|date:"F j, Y" }}
                    </li>
                {% endif %}
            </ul>
        </div>
        <div class="offering-type">
            <label>
                {% if object_type == "course" %}
                    Single
                {% else %}
                    Multi
                {% endif %}
                Course Online
            </label>
        </div>
    </div>
    <div class="bottom">
      {% with page_id=courseware_page.pk|stringformat:"i" %}
        {% with collapse_id="collapsible_"|add:tab|add:"_"|add:page_id collapse_input_id="collapse_"|add:tab|add:"_"|add:page_id %}
        <input type="checkbox" class="toggle" id="{{ collapse_input_id }}" data-target="#{{ collapse_id }}" data-toggle="collapse" />
        <label for="{{ collapse_input_id }}" class="lbl-toggle">
            Details
        </label>
        <div id="{{ collapse_id }}" class="collapse">
          <div class="details-body">
            {% if courseware_page.catalog_details %}
              <div class="description">{{ courseware_page.catalog_details|richtext }}</div>
            {% endif %}
            {% if object_type == "program" %}
              <ul class="program-course-links">
                {% for course_page in courseware_page.course_pages %}
                  <li>
                    <a href="{% pageurl course_page %}">
                      {{ course_page.title }}
                    </a>
                  </li>
                {% endfor %}
                </ul>
                <a href="{% pageurl courseware_page %}" class="link-button">
                  View Program
                </a>
            {% endif %}
            {% if object_type == "course" %}
              <a href="{% pageurl courseware_page %}" class="link-button">
                View Course
              </a>
            {% endif %}
          </div>
        </div>
        {% endwith %}
      {% endwith %}
    </div>
</div>
